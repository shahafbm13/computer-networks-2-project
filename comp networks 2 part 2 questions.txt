comp network lab 2 questions

no problem with sending msgs after creation

links should not have queues, move it to switches


how to count HoL blocking
when packet suppoused to send but cant, check next packet to send


fifo implementation - search for earliest arrival time between top of queues



switch receiving msgs:
add to table
if not flood:
	put msg in appropriate queue
	create msg sending event and put it in a seperate sending timeline
	
if flood:
	duplicate msgs
	for each msg duplicated:
		if link free:
			send
		if link not free:
			put in head of respective queue and timeline with same scheduling time as original msg


switch sending msgs:


update flood:
done - find sending host
input done, need to do output - duplicate original message and put duplicates in same queue

done - create sending events for new messages, place them in timeline and sort it


todo:
done - update receiving msgs
add check for sending msg queue
add sending event creation
add receiving msg not in flood

sending event:
find sending switch
find curr message
find correct link
if link is busy:
	cant_send flag=true ????
	calculate HoL blocking
	place curr message event right after switches last departure time

	
if link is not busy:
    remove from queue
	send message
	update departure times ????



calculate HoL blocking:
find top of queues and sort by scheduling time
find curr_message from top of queues
find next_message_from_top_of_queues from top of queues
find curr_queue
for message in curr_queue:
	if message.scheduling_time < next_message_from_top_of_queues.scheduling_time:
	    CHECK IF LINK IS FREE ??????
		total_hol_time +=1
	else:
		break
----------------------------------------------------------------------------------------------------------------
after message created
go over switch queue, find the earliest message
check if dst is known to switch
if known:
    if link is free:
        send to dst
    if link is not free:
        continue to next create event
if not known:
    flood:
        find hosts that are not src of message
        for each valid host:
            try to send message:
                if link is free:
                    send
                if link is not free:
                    put in head of respective queue



sending from host to switch:
link sends from host to switch
switch receives message:
    add to correct queue


send_rest_of_buffers_and_queues:
while there are messages in queues or buffers:
    for each switch:
        find earliest message in top of queues
        try to send earliest message:
            if link is free:
                send message to dst host
            if link is not free:
                calculate hol blocking
                continue to next buffer message
    for each host:
        find earliest message from buffers
        try to send earliest message:
            if link is free:
                send message to switch
            if link is not free:
                continue to next switch message

----------------------------------------------------------------------------------------------------------------


